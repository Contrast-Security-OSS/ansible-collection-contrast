# Vagrant Testing Configuration
# This file contains configuration for comprehensive Vagrant-based testing

# VM Resource Configuration
VM_MEMORY=1024
VM_CPUS=1
VM_DISK_SIZE=10240

# Test Configuration
DEFAULT_AGENT_VERSION="6.19.0"
DEFAULT_CONFIG_METHOD="systemd"
DEFAULT_SERVICE_NAME="tomcat"

# Network Configuration
NETWORK_TYPE="private_network"
NETWORK_DHCP=true
BASE_IP="192.168.56"

# Test Scenarios Configuration
declare -A TEST_CONFIGS=(
    # Basic installation test
    ["basic"]="
        contrast_agent_enabled: true
        contrast_agent_version: '$DEFAULT_AGENT_VERSION'
        contrast_config_method: '$DEFAULT_CONFIG_METHOD'
        contrast_test_mode: true
    "
    
    # Environment variable configuration test
    ["env_config"]="
        contrast_agent_enabled: true
        contrast_config_source: 'environment'
        contrast_security_config:
          api:
            url: 'https://app.contrastsecurity.com/Contrast'
            api_key: 'test-api-key'
          application:
            name: 'TestApp'
    "
    
    # YAML configuration test
    ["yaml_config"]="
        contrast_agent_enabled: true
        contrast_config_source: 'yaml'
        contrast_security_config:
          api:
            url: 'https://app.contrastsecurity.com/Contrast'
            api_key: 'test-api-key'
          agent:
            logger:
              level: 'INFO'
    "
    
    # setenv.sh configuration test
    ["setenv_config"]="
        contrast_agent_enabled: true
        contrast_config_method: 'setenv'
        contrast_service_name: '$DEFAULT_SERVICE_NAME'
    "
    
    # Deactivation test
    ["deactivation"]="
        contrast_agent_enabled: false
        contrast_config_method: '$DEFAULT_CONFIG_METHOD'
    "
)

# OS-specific configurations
declare -A OS_CONFIGS=(
    ["ubuntu2004"]="
        java_package: 'openjdk-11-jdk'
        tomcat_package: 'tomcat9'
        service_name: 'tomcat9'
        package_manager: 'apt'
    "
    
    ["ubuntu2204"]="
        java_package: 'openjdk-11-jdk'
        tomcat_package: 'tomcat9'
        service_name: 'tomcat9'
        package_manager: 'apt'
    "
    
    ["centos8"]="
        java_package: 'java-11-openjdk-devel'
        tomcat_package: 'tomcat'
        service_name: 'tomcat'
        package_manager: 'yum'
    "
    
    ["rocky9"]="
        java_package: 'java-11-openjdk-devel'
        tomcat_package: 'tomcat'
        service_name: 'tomcat'
        package_manager: 'dnf'
    "
    
    ["amazonlinux2"]="
        java_package: 'java-11-amazon-corretto-devel'
        tomcat_package: 'tomcat'
        service_name: 'tomcat'
        package_manager: 'yum'
    "
)

# Test timeouts (in minutes)
VM_START_TIMEOUT=10
TEST_EXECUTION_TIMEOUT=30
VM_DESTROY_TIMEOUT=5

# Parallel execution settings
MAX_PARALLEL_VMS=3
PARALLEL_ENABLED=false

# Logging configuration
LOG_LEVEL="INFO"
LOG_TO_FILE=true
LOG_DIRECTORY="test-results"

# Cleanup settings
AUTO_CLEANUP=true
KEEP_LOGS=true
SNAPSHOT_BEFORE_TEST=false

# Advanced settings
VAGRANT_PROVIDER="virtualbox"
ANSIBLE_VERBOSITY=1
MOLECULE_DEBUG=false

# Test data locations
TEST_DATA_DIR="tests/data"
INVENTORY_FILE="tests/vagrant/inventory"
SETUP_PLAYBOOK="tests/vagrant/setup.yml"

# Custom test configurations can be added here
# Format: TEST_NAME="ansible_variable: value"
CUSTOM_TESTS=(
    # Add your custom test configurations here
    # Example:
    # "custom_version_test=contrast_agent_version: '6.18.0'"
)

# CI/CD specific settings
CI_MODE=false
CI_PARALLEL_JOBS=2
CI_ARTIFACT_RETENTION_DAYS=7

# Export all variables for use in scripts
export VM_MEMORY VM_CPUS VM_DISK_SIZE
export DEFAULT_AGENT_VERSION DEFAULT_CONFIG_METHOD DEFAULT_SERVICE_NAME
export NETWORK_TYPE NETWORK_DHCP BASE_IP
export VM_START_TIMEOUT TEST_EXECUTION_TIMEOUT VM_DESTROY_TIMEOUT
export MAX_PARALLEL_VMS PARALLEL_ENABLED
export LOG_LEVEL LOG_TO_FILE LOG_DIRECTORY
export AUTO_CLEANUP KEEP_LOGS SNAPSHOT_BEFORE_TEST
export VAGRANT_PROVIDER ANSIBLE_VERBOSITY MOLECULE_DEBUG
export TEST_DATA_DIR INVENTORY_FILE SETUP_PLAYBOOK
export CI_MODE CI_PARALLEL_JOBS CI_ARTIFACT_RETENTION_DAYS
